name: Create Copilot Coding Task

on:
  workflow_dispatch:
    inputs:
      task_description:
        description: 'What should Copilot build/fix?'
        required: true
        default: 'Refactor Sample.cs methods to use PascalCase naming convention'

permissions:
  issues: write
  contents: read

jobs:
  create-task:
    runs-on: ubuntu-latest
    
    steps:
      - name: Create GitHub Issue for Copilot
        env:
          GH_TOKEN: ${{ github.token }}
        run: |
          cat > issue-body.md << 'ISSUE_EOF'
          ## ðŸ¤– Automated Coding Task

          ### Task Description
          ${{ inputs.task_description }}

          ---

          ### ðŸ“‹ Coding Guidelines to Follow

          Please review and follow the coding guidelines available at:
          
          **Guidelines Repository:** https://github.com/antoleandarius/dotnet-guidelines-poc
          
          **Direct Links:**
          - [Naming Conventions](https://github.com/antoleandarius/dotnet-guidelines-poc/blob/main/naming.md)
          
          > **Note:** All code changes must comply with the guidelines linked above.

          ---

          ### Instructions for GitHub Copilot
          - Review the guidelines at the links above
          - Implement the changes described in the task
          - Follow all naming conventions strictly (PascalCase for methods)
          - Ensure all code complies with the documented standards
          - Create a PR when complete

          @copilot please implement this task following the guidelines linked above.
          ISSUE_EOF
          
          gh issue create \
            --repo ${{ github.repository }} \
            --title "Copilot Task: ${{ inputs.task_description }}" \
            --body-file issue-body.md
